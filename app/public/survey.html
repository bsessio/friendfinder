<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Friend Finder Survey</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
      integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr"
      crossorigin="anonymous"
    />
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
  </head>
  <body>
    <div class="blob">
        <h1 class="center"><i class="fas fa-person-booth"></i> Friend Finder</h1>
        <hr />
          <div class="quizFields">
        <label for="name">Your name:</label>
        <input placeholder="First name and Last name" id="name" />
      </div>

      <div class="quizFields">
        <label for="photo">Link to photo:</label>
        <input placeholder="paste URL here" id="photo" />
      </div>

      <p class="newPage">How do you feel about...</p>
      <div class="quizFields">
        <label for="zeroth">Sushi?</label>
        <select id="zeroth">
          <option value="" selected disabled hidden>Click here to choose</option
          ><option value="1">Strongly opposed</option>
          <option value="2">Opposed</option>
          <option value="3">Indifferent</option>
          <option value="4">Supportive</option>
          <option value="5">Strongly supportive</option>
        </select>
      </div>

      <div class="quizFields">
        <label for="oneth">Geekiness?</label>
        <select id="oneth">
          <option value="" selected disabled hidden>Click here to choose</option
          ><option value="1">Strongly opposed</option>
          <option value="2">Opposed</option>
          <option value="3">Indifferent</option>
          <option value="4">Supportive</option>
          <option value="5">Strongly supportive</option>
        </select>
      </div>

      <div class="quizFields">
        <label for="twoth">New Star Wars?</label>
        <select id="twoth">
          <option value="" selected disabled hidden>Click here to choose</option
          ><option value="1">Strongly opposed</option>
          <option value="2">Opposed</option>
          <option value="3">Indifferent</option>
          <option value="4">Supportive</option>
          <option value="5">Strongly supportive</option>
        </select>
      </div>

      <div class="quizFields">
        <label for="threeth">Donald Trump?</label>
        <select id="threeth">
          <option value="" selected disabled hidden>Click here to choose</option
          ><option value="1">Strongly opposed</option>
          <option value="2">Opposed</option>
          <option value="3">Indifferent</option>
          <option value="4">Supportive</option>
          <option value="5">Strongly supportive</option>
        </select>
      </div>

      <div class="quizFields">
        <label for="fourth">Religion?</label>
        <select id="fourth">
          <option value="" selected disabled hidden>Click here to choose</option
          ><option value="1">Strongly opposed</option>
          <option value="2">Opposed</option>
          <option value="3">Indifferent</option>
          <option value="4">Supportive</option>
          <option value="5">Strongly supportive</option>
        </select>
      </div>

      <div class="quizFields">
        <label for="fiveth">Dogs?</label>
        <select id="fiveth">
          <option value="" selected disabled hidden>Click here to choose</option
          ><option value="1">Strongly opposed</option>
          <option value="2">Opposed</option>
          <option value="3">Indifferent</option>
          <option value="4">Supportive</option>
          <option value="5">Strongly supportive</option>
        </select>
      </div>

      <div class="quizFields">
        <label for="sixth">Cats?</label>
        <select id="sixth">
          <option value="" selected disabled hidden>Click here to choose</option
          ><option value="1">Strongly opposed</option>
          <option value="2">Opposed</option>
          <option value="3">Indifferent</option>
          <option value="4">Supportive</option>
          <option value="5">Strongly supportive</option>
        </select>
      </div>

      <div class="quizFields">
        <label for="seventh">Cops?</label>
        <select id="seventh">
          <option value="" selected disabled hidden>Click here to choose</option
          ><option value="1">Strongly opposed</option>
          <option value="2">Opposed</option>
          <option value="3">Indifferent</option>
          <option value="4">Supportive</option>
          <option value="5">Strongly supportive</option>
        </select>
      </div>

      <div class="quizFields">
        <label for="eightth">Dr. Who?</label>
        <select id="eightth">
          <option value="" selected disabled hidden>Click here to choose</option
          ><option value="1">Strongly opposed</option>
          <option value="2">Opposed</option>
          <option value="3">Indifferent</option>
          <option value="4">Supportive</option>
          <option value="5">Strongly supportive</option>
        </select>
      </div>

      <div class="quizFields">
        <label for="nineth">Taco Bell?</label>
        <select id="nineth">
          <option value="" selected disabled hidden>Click here to choose</option
          ><option value="1">Strongly opposed</option>
          <option value="2">Opposed</option>
          <option value="3">Indifferent</option>
          <option value="4">Supportive</option>
          <option value="5">Strongly supportive</option>
        </select>
      </div>

      <div class="newPage">
        <button type="submit" id="survey" data-target="#myModal">
          SUBMIT SURVEY
        </button>
      </div>
      <p class="center">
          <a href="/api/friends">API Friends List</a> |
          <a href="https://github.com/bsessio/Friendfinder">GitHub Repo</a>
        </p>
        </div>
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- <script src="server.js"></script> -->
    <div id="myModal" class="modal fade" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">
              &times;
            </button>
            <h4 class="modal-title">Your New Best Friend</h4>
          </div>
          <div class="modal-body">
            <h2 id="match-name"></h2>
            <img id="match-img" src="" alt="match image" max-width="75%" />
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
    <script type="text/javascript">
      let iFriend = false;
      let checkState = "";
      $("#survey").on("click", function(event) {
        event.preventDefault();
        if (
          $("#name").val() === "" ||
          $("#photo").val() === "" ||
          $("#zeroth").val() === "" ||
          $("#oneth").val() === "" ||
          $("#twoth").val() === "" ||
          $("#threeth").val === "" ||
          $("#fourth").val === "" ||
          $("#fiveth").val === "" ||
          $("#sixth").val === "" ||
          $("#seventh").val === "" ||
          $("#eightth").val === "" ||
          $("#nineth").val === ""
        ) {
          alert("This form was not filled out correctly, please try again.");
        } else if (iFriend != "") {
          if (checkState === $("#name").val()) {
            alert("You have already been entered into our system.");
          } else {
            if (checkState != $("#name").val()) {
              friendAdd();
            }
          }
        } else {
          friendAdd();
        }
      });
      function friendAdd() {
        iFriend = {
          friendName: $("#name")
            .val()
            .trim(),
          photoURL: $("#photo")
            .val()
            .trim(),
          scores: [
            parseFloat(
              $("#zeroth")
                .val()
                .trim()
            ),
            parseFloat(
              $("#oneth")
                .val()
                .trim()
            ),
            parseFloat(
              $("#twoth")
                .val()
                .trim()
            ),
            parseFloat(
              $("#threeth")
                .val()
                .trim()
            ),
            parseFloat(
              $("#fourth")
                .val()
                .trim()
            ),
            parseFloat(
              $("#fiveth")
                .val()
                .trim()
            ),
            parseFloat(
              $("#sixth")
                .val()
                .trim()
            ),
            parseFloat(
              $("#seventh")
                .val()
                .trim()
            ),
            parseFloat(
              $("#eightth")
                .val()
                .trim()
            ),
            parseFloat(
              $("#nineth")
                .val()
                .trim()
            )
          ]
        };
        var self = iFriend.friendName;
        $.post("/api/friends", iFriend, function(data) {
          console.log(data);
        }).then(function(data) {
          checkState = self;
          $("#match-name").text(data.friendName);
          $("#match-img").attr("src", data.photoURL);

          $("#myModal").modal("show");
        });
      }
    </script>
  </body>
</html>
